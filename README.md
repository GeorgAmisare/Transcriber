# Transcriber

Минимальная структура приложения для транскрибации встреч.

## Требования к окружению

- Python 3.10+
- Установленный [FFmpeg](https://ffmpeg.org/)
- Подключение к интернету

## Установка

```bash
python -m venv .venv
source .venv/bin/activate  # Windows: .venv\Scripts\activate
pip install -r requirements.txt
```

## Запуск

Перед стартом работы скопируйте `example.env` в `.env` и укажите в нём токен
Hugging Face (`HF_TOKEN`). При необходимости включите расширенные тесты,
установив `TEST_WITH_MATERIALS=1`. Файл `.env` не добавляется в репозиторий,
но приложение использует эти переменные окружения.

```bash
python app.py
```

Ограничения входных файлов:

- длительность не более 90 минут;
- размер не более 2 ГБ.

## Требования к файлам

Поддерживаются популярные аудио- и видеоформаты (MP4, MOV, MP3, WAV и др.).

## Whisper и токен Hugging Face

Модель Whisper загружается из репозитория Hugging Face. Для доступа
используется токен. В репозитории есть пример `example.env`, создайте на его
основе локальный файл `.env`:

```
HF_TOKEN=ваш_токен
# Установите 1, чтобы запускать тесты с локальными медиафайлами
TEST_WITH_MATERIALS=0
```

При запуске модуль автоматически подгружает этот токен и выполняет вход в
`huggingface_hub`.

## Запуск тестов
Перед запуском тестов необходимо задать токен Hugging Face в переменной
окружения `HF_TOKEN`. При желании можно включить проверку локальных
медиафайлов, установив `TEST_WITH_MATERIALS=1`. Пример:

```
export HF_TOKEN=ваш_токен
# export TEST_WITH_MATERIALS=1  # проверять локальные медиафайлы
pytest
```

Тесты автоматически используют эти переменные. При отсутствии `HF_TOKEN`
проверки с маркером `needs_hf` будут пропущены.

## Сборка и запуск под Windows

Для создания исполняемого файла необходимо установить зависимости и пакет
`pyinstaller`, после чего выполнить скрипт сборки:

```bash
pip install -r requirements.txt
pip install pyinstaller
python build.py
```

После выполнения в каталоге `dist` появится файл `transcriber.exe`. Его
можно запустить двойным щелчком или из терминала:

```bash
dist\\transcriber.exe
```

## Обновление документации

Этот файл необходимо актуализировать при добавлении новой функциональности.

